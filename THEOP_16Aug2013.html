<html>
<head>
<title>THEOP_16Aug2013</title>
<style type="text/css">
<!--
/*
    This style sheet is borrowed from the NetLogo User Manual.  However, some of the units were
    changed from em to px because Java's StyleSheet support is limited for relative units such as
    em and % (this will supposively improve with newer versions of the VM) - jrn 7/21/05
    BE VERY VERY CAREFUL when you alter this style sheet -- it's possible to put in
    innocent-looking things that work on some VM's but cause Java exceptions on other for example
    we were using "font-size: 125%" but it caused Java exceptions on Java 1.5 on Windows - ST
    8/25/05
*/
:link { color: rgb(110,0,110); }
:visited { color: rgb(110,0,110); }
body {
    margin-left: 5px;
    font-family: arial, sans-serif;
    background: white;
    font-size: 12pt
}
h1 {
    color: white;
    background: rgb(45,0,45);
    font-size: 18pt;
    margin-bottom: 4px;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h2 {
    margin-top: 15px;
    margin-left: 6px;
    margin-bottom: 4px;
    background: rgb(166,172,255);
    font-size: 15pt;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h3 {
    margin-top: 15px;
    margin-left: 13px;
    margin-bottom: 4px;
    background: rgb(175,175,175);
    font-size: 12pt;
    padding: 0.2em;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h4 {
    margin-top: 15px;
    margin-bottom: 5px;
    margin-left: 15px;
    font-size: 12pt;
}
h5 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
h6 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
p {
    margin-left: 15px;
    margin-bottom: 3px;
}
pre {
    margin-left: 13px;
    background: rgb(225,225,225);
    font-family: monospace;
    font-size: 12pt;
    padding-left: 10px;
    padding-right: 3px;
    padding-top: 7px;
    padding-bottom: 7px;
    margin-top:9px;
    margin-bottom:0px;
}
code {
    font-family: monospace;
    font-size: 12pt;
}
blockquote {
    border: solid;
    border-style: solid;
    border-width: thin;
    border-color: black;
    background: rgb(250,250,220);
    padding-top: 0px;
    padding-bottom: 7px;
    margin-top: 7px;
    margin-bottom:1px;
}
ol {
   margin-bottom:1px;
}
ul {
   margin-bottom:1px;
}

-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 5.0.1.</p>

<p>The applet requires Java 5 or higher.
Java must be enabled in your browser settings.
Mac users must have Mac OS X 10.4 or higher.
Windows and Linux users may obtain the latest Java from
<a href="http://www.java.com/">Oracle's Java site</a>.</p>

<p><hr>



<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="1273" height="541">
  <param name="DefaultModel"
         value="THEOP_16Aug2013.nlogo">
  <param name="java_arguments"
         value="-Djnlp.packEnabled=true">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="THEOP_16Aug2013.nlogo">THEOP_16Aug2013.nlogo</a></p>
<p>WHAT IT IS</p><p>This model has been developed by Paola Tubaro, Antonio A. Casilli and Yasaman Sarabi as part of the THEOP project, funded by Fondation CIGREF in 2011-2012. It accompanies the book &ldquo;AGAINST THE HYPOTHESIS OF THE END OF PRIVACY: An Agent-Based Modeling Approach to Social Media&rdquo;, Springer, SpringerBriefs in Digital spaces series (in press).</p><p>The model has been realised in Netlogo (Wilensky 1999). </p><p>The model is released under a Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License (cf. <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/)">http://creativecommons.org/licenses/by-nc-sa/3.0/)</a>.</p><p>THEOP sets out to study the so-called “End of Privacy” hypothesis according to which today’s pervasive computer-mediated communication generates a tendency, especially among younger generations, to renounce the value of privacy in favour of an open, connected existence. THEOP aims to identify, in theoretical perspective, the conditions that may actually bring this scenario into being.</p><p>HOW IT WORKS</p><p>The model represents an online social network in which agents form, maintain and delete online ties to build their social capital, while having to disclose some of their personal information to better interact with others. There is a tension between the need to disclose more to form better social capital, and the need to keep one&rsquo;s information private.</p><p>The model also accounts for the fact that the processes of selection (choice of contacts/friends) and social influence (behaviour change induced by relationships with contacts/friends) in a social network also affect privacy choices, and are in turn affected by them. Selection determines to whom contents are disclosed, while influence determines what is disclosed, in a dynamic process with feedback. </p><p>The model consists of a population of agents operating in an environment, mimicking an online social networking service.</p><p>The environment is characterised by two main features:</p>
<ul>
  <li>Dissonance (D), indicates openness to social influence by others.</li>
  <li>Bonding / Bridging threshold (BB), indicates the extent to which bonding ties (with close others) are preferred to bridging ties in the creation of social capital.</li>
</ul><p>Two more minor features (with few effects on model results) are the number of agents (assumed fixed during a simulation run) and the number of ties at initialisation.</p><p>The environment also includes a set of options:<br/> - &ldquo;Privacy-On&rdquo; vs. &ldquo;Privacy-Off&rdquo;: in the former case, simulations account for the possibility of agents to change their privacy levels from 0 (always visible to all) to 1 (visible only to direct contacts), and vice versa; in the latter case, Privacy is always set to 0 (always visible).<br/> - Possibility of &ldquo;Privacy Interventions&rdquo;: if present, the network service provider resets all privacy levels to 0 if mean privacy has been above 0.5 for a long time; if absent, there are no such interventions.<br/> - &ldquo;Sensitivity&rdquo;, that is, in Privacy-On simulations, what network structural aspect induces agents to react by resetting their privacy levels from 0 to 1: in the case of &ldquo;Network size&rdquo;, an agent resets its privacy to 1 if it has links to 3/4 of all agents; in the case of &ldquo;Network density&rdquo;, an agent resets its privacy to 1 if its local density (measured through its clustering coefficient) is equal to at least 0.75.</p><p>All these parameters are user-defined and do not change in the course of a simulation run.</p><p>In turn, individual agents are characterised by two variables:<br/> - Privacy setting (binary, taking value 0 or 1);<br/> - Cultural practices (a vector with three dimensions, here labelled z1, z2 and z3; each is a continuous variable defined on the interval [0; 1]).<br/>The values of these variables are assigned randomly at initialisation, and evolve endogenously during the simulation.</p><p>THINGS TO TRY</p><p>Choose your preferred simulation parameters and press the &ldquo;Setup&rdquo; button to initialize the model. You will see the initial structure of the network in the main View panel of the Interface.</p><p>Then, press the &ldquo;Go&rdquo; button to start a simulation run. The system stops automatically once it reaches the stationary state; at that moment, it also exports all values of variables and constants. If you wish to stop it earlier, press the &ldquo;Go&rdquo; button again.</p><p>While the simulation is running, you can see the evolution of the network structure in the main view, and follow changes in key indicators in the plots situated to the right of the screen:<br/> - Global network density and local density (as measured by the clustering coefficient, an average of the density of the personal networks of agents);<br/> - Values of the cultural practices of agents z1, z2 and z3 (group averages);<br/> - Number and size of network components;<br/> - Average level of privacy in the system. </p><p>REFERENCES<br/>Wilensky, U. 1999. NetLogo. <a href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</a>. Center for Connected Learning and Computer-Based Modeling, Northwestern University. Evanston, IL. </p>

<h1>CODE</h1>
<pre><font color="#5a5a5a">;; THEOP project;</font><font color="#000000">
</font><font color="#5a5a5a">;; August 2013 version;</font><font color="#000000">
</font><font color="#5a5a5a">;; by Paola Tubaro &amp; Antonio Casilli &amp; Yasaman Sarabi;;</font><font color="#000000">

</font><font color="#5a5a5a">;; This version: 16th August 2013;</font><font color="#000000">

</font><font color="#5a5a5a">;; &quot;Privacy On&quot; simulations account for the possibility of agents to change their privacy levels from 0 (always visible) to 1 (visible only to friends) , and vice versa;</font><font color="#000000">
</font><font color="#5a5a5a">;; &quot;Privacy Off&quot; simulations do not allow that: Privacy is always set to 0 (always visible)</font><font color="#000000">

</font><font color="#5a5a5a">;; This version includes the possibility to account for external interventions by network providers to reset privacy to 0</font><font color="#000000">
</font><font color="#5a5a5a">;; to see if behaviours cycle over time</font><font color="#000000">
</font><font color="#5a5a5a">;; this is regulated through the &quot;Interventions?&quot; toggle</font><font color="#000000">
</font><font color="#5a5a5a">;; If it is On, it is assumed that network service provider resets all privacy levels to 0 if they have been above 0.5 for 500 consecutive time steps;</font><font color="#000000">
</font><font color="#5a5a5a">;; If it is Off, there are no such interventions </font><font color="#000000">

</font><font color="#5a5a5a">;; Depending on the value of the &quot;Sensitivity&quot; parameter, individual privacy choices depend on:</font><font color="#000000">
</font><font color="#5a5a5a">;; - personal network size, or</font><font color="#000000">
</font><font color="#5a5a5a">;; - personal network density (i.e. value of the actor's clustering coefficient)</font><font color="#000000">
</font><font color="#5a5a5a">;; if size is chosen, an agent resets its privacy to 1 if it has links to 3/4 of all agents;</font><font color="#000000">
</font><font color="#5a5a5a">;; if density is chosen, an agent resets its privacy to 1 if its clustering coefficient (CC) is equal to at least 0.75</font><font color="#000000">

</font><font color="#5a5a5a">;; the other key variables are BondBridgThreshold (BB), regulating the type of social capital (bonding or bridging);</font><font color="#000000">
</font><font color="#5a5a5a">;; and Dissonance (D), regulating the degree of openness to cultural and social influence from others.</font><font color="#000000">



</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;; Define global indicators ;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

 </font><font color="#007f69">globals</font><font color="#000000"> [isolates      </font><font color="#5a5a5a">; number of nodes with no links to others</font><font color="#000000">
          components    </font><font color="#5a5a5a">; number of groups of at least two nodes</font><font color="#000000">
          density       </font><font color="#5a5a5a">; density is number of actual links divided by number of possible links</font><font color="#000000">
                        </font><font color="#5a5a5a">; the latter is equal to: (number of turtles * number of turtles - 1)/2 </font><font color="#000000">
          stationary    </font><font color="#5a5a5a">; how many times the model has remained stable, i.e. number of links has not changed</font><font color="#000000">
          privacy-alert </font><font color="#5a5a5a">; how many times average privacy has remained above its expected value of 0.5</font><font color="#000000">
         
          ]
      




</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;; Define agent attributes ;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

            </font><font color="#5a5a5a">; these are the characteristics of each individual</font><font color="#000000">
            </font><font color="#5a5a5a">; &quot;turtles&quot; are &quot;agents&quot; in Netlogo's jargon</font><font color="#000000">
</font><font color="#007f69">turtles-own</font><font color="#000000"> [z
            </font><font color="#5a5a5a">; z is the vector/list of z1, z2, and z3 (cultural practices)</font><font color="#000000">
            </font><font color="#5a5a5a">; it is a real value on the [0, 1] interval</font><font color="#000000">
            x
            </font><font color="#5a5a5a">; x is privacy</font><font color="#000000">
            </font><font color="#5a5a5a">; it is a binary variable</font><font color="#000000">
            a
            </font><font color="#5a5a5a">; a is tendency to anomie</font><font color="#000000">
              </font><font color="#5a5a5a">; it is a real value on the [0, 1] interval</font><font color="#000000">
            </font><font color="#5a5a5a">; this is to account for different propensity to friendship</font><font color="#000000">
            
            </font><font color="#5a5a5a">; the following five variables are operational only, and do not have substantive meaning</font><font color="#000000">
            group
            </font><font color="#5a5a5a">; component to which the turtle belongs</font><font color="#000000">
            missed
            </font><font color="#5a5a5a">; number of times a turtle has the opportunity to create ties, yet remains isolate</font><font color="#000000">
            explored? 
            </font><font color="#5a5a5a">; marks turtle as &quot;read&quot; in order to count # of components </font><font color="#000000">
             dz
             </font><font color="#5a5a5a">; measures distance between the z of two distinct turtles </font><font color="#000000">
             </font><font color="#5a5a5a">; allows accounting for cultural similarities without assuming individual agents are necesarilly identical</font><font color="#000000">
             zdist
             </font><font color="#5a5a5a">; measures distance between the z of one turtle and reference values for its group (visually = colors)</font><font color="#000000">
             node-clustering-coefficient
             </font><font color="#5a5a5a">; this is the local density of an agent's personal network</font><font color="#000000">
             </font><font color="#5a5a5a">; it is computed as number of actual links between its friends, divided by number of possible links between them </font><font color="#000000">
             </font><font color="#5a5a5a">; the latter is equal to: (number of friends * number of friends - 1)/2  </font><font color="#000000">
             ]




</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;; Setup Procedures ;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#5a5a5a">; this is step 0 in a simulation run (initialization)</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> setup
  
  </font><font color="#0000aa">clear-all</font><font color="#000000"> </font><font color="#5a5a5a">; cancels everything previously existing;</font><font color="#000000">
  </font><font color="#0000aa">reset-ticks</font><font color="#000000"> </font><font color="#5a5a5a">; resets time</font><font color="#000000">
  </font><font color="#0000aa">clear-all-plots</font><font color="#000000"> </font><font color="#5a5a5a">; cancels all previous plots</font><font color="#000000">
  
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">]
  </font><font color="#5a5a5a">; colors screen white to prepare for network visualization</font><font color="#000000">
  
  </font><font color="#0000aa">crt</font><font color="#000000"> #Agents </font><font color="#5a5a5a">; create #Agents nodes (number #Agents is user-defined);</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> 
               </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle&quot;</font><font color="#000000">             
               </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">
               ]
  </font><font color="#5a5a5a">;; make them look all the same (black, circles), and smaller than the default value;</font><font color="#000000">
  
  </font><font color="#5a5a5a">; if privacy settings are on</font><font color="#000000">
  </font><font color="#5a5a5a">; gives privacy to each turtle</font><font color="#000000">
  </font><font color="#5a5a5a">; privacy = 0 means seen by all</font><font color="#000000">
  </font><font color="#5a5a5a">; privacy = 1 means seen only by direct contacts (friends)</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">ifelse</font><font color="#000000"> Privacy? [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">]
                               [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#963700">0</font><font color="#000000">]]

  </font><font color="#5a5a5a">; from the viewpoint of the service provider, set up an alert if more than half agents have their privacy settings on</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [x] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">
              [</font><font color="#0000aa">set</font><font color="#000000"> privacy-alert </font><font color="#963700">0</font><font color="#000000">]
              [</font><font color="#0000aa">set</font><font color="#000000"> privacy-alert </font><font color="#963700">1</font><font color="#000000">]

    
  </font><font color="#5a5a5a">;; take a subset of turtles and </font><font color="#000000">
  </font><font color="#5a5a5a">;; create a link between each of them and another one,</font><font color="#000000">
  </font><font color="#5a5a5a">;; chosen at random from the group;</font><font color="#000000">
  </font><font color="#5a5a5a">;; provided the turtle can be seen by all (privacy = 0)</font><font color="#000000">
  </font><font color="#5a5a5a">;; the size of the subset is user-defined</font><font color="#000000">
  
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> #InitialTies </font><font color="#660096">turtles</font><font color="#000000"> [ </font><font color="#0000aa">create-link-with</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [x </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]]
   
   
  </font><font color="#5a5a5a">; count number of network components (= sub-graphs separated from one another)</font><font color="#000000">
  </font><font color="#5a5a5a">; color each of them differently</font><font color="#000000">
  </font><font color="#5a5a5a">; plot number and size of components</font><font color="#000000">
  detect-components
  color-group
  plot-components
 
  </font><font color="#5a5a5a">; layout algorithm for network visualization</font><font color="#000000">
  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000"> [do-layout]
 

  </font><font color="#5a5a5a">; give values of practices z (z1 z2 z3) to each turtle  </font><font color="#000000">
  </font><font color="#5a5a5a">; based on color (at setup)</font><font color="#000000">
  give-z

  </font><font color="#5a5a5a">; gives values for tendency to anomie</font><font color="#000000">
  </font><font color="#5a5a5a">; we take anomie as a randomly distributed variable</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> a </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]

</font><font color="#007f69">end</font><font color="#000000">

   


</font><font color="#5a5a5a">; procedure called by setup and by go</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> detect-components 
 </font><font color="#0000aa">set</font><font color="#000000"> isolates </font><font color="#963700">0</font><font color="#000000">
 </font><font color="#0000aa">set</font><font color="#000000"> components </font><font color="#963700">0</font><font color="#000000"> 
 </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> explored? </font><font color="#963700">0</font><font color="#000000">
              </font><font color="#0000aa">set</font><font color="#000000"> group </font><font color="#963700">0</font><font color="#000000">]
 </font><font color="#5a5a5a">;; keep exploring till all turtles get explored</font><font color="#000000">
  </font><font color="#0000aa">loop</font><font color="#000000">
  [
    </font><font color="#5a5a5a">;; pick a node that has not yet been explored</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> start </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [explored? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ]
    </font><font color="#0000aa">if</font><font color="#000000"> start </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000"> ]
    </font><font color="#0000aa">ask</font><font color="#000000"> start [</font><font color="#0000aa">set</font><font color="#000000"> explored? </font><font color="#963700">1</font><font color="#000000">
              
              </font><font color="#5a5a5a">; first check if start has any links</font><font color="#000000">
              </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">
             
              </font><font color="#5a5a5a">; if yes, explore how many nodes can be reached from it</font><font color="#000000">
              </font><font color="#5a5a5a">; update number of components</font><font color="#000000">
              </font><font color="#5a5a5a">; and give the turtle a group number</font><font color="#000000">
              [</font><font color="#0000aa">set</font><font color="#000000"> components components </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
              </font><font color="#0000aa">set</font><font color="#000000"> group components
              explore]
              
              </font><font color="#5a5a5a">;if start has no links, update count of isolates</font><font color="#000000">
              </font><font color="#5a5a5a">; and leave start in group 0</font><font color="#000000">
              </font><font color="#5a5a5a">;; nb. group 0 is not a real group or component;</font><font color="#000000">
              </font><font color="#5a5a5a">;; it is only the category where we put isolates</font><font color="#000000">
              [</font><font color="#0000aa">set</font><font color="#000000"> isolates isolates </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
              </font><font color="#0000aa">set</font><font color="#000000"> group </font><font color="#963700">0</font><font color="#000000">
              ]]
   ]           
</font><font color="#007f69">end</font><font color="#000000"> 

    
</font><font color="#5a5a5a">; procedure called by detect-components, if not an isolate</font><font color="#000000">
</font><font color="#5a5a5a">; the links of start are given the same group</font><font color="#000000">
</font><font color="#5a5a5a">; and they are asked to explore in turn</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> explore
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [</font><font color="#0000aa">if</font><font color="#000000"> explored? </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">stop</font><font color="#000000">]
                        </font><font color="#0000aa">set</font><font color="#000000"> explored? </font><font color="#963700">1</font><font color="#000000">
                        </font><font color="#0000aa">set</font><font color="#000000"> group components
                        explore]
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">; procedure called by setup</font><font color="#000000">
</font><font color="#5a5a5a">; at setup, color is attributed depending on group</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> color-group
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
  </font><font color="#0000aa">loop</font><font color="#000000"> 
  [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i]
                  </font><font color="#5a5a5a">; define color as a function of the group</font><font color="#000000">
                  </font><font color="#5a5a5a">; to which a turtle belongs</font><font color="#000000">
                  </font><font color="#5a5a5a">; unless turtle is an isolate (color = black)</font><font color="#000000">
                  </font><font color="#5a5a5a">; links are of the same color as the turtles at each end</font><font color="#000000">
                  </font><font color="#5a5a5a">; color are defined according to the Netlogo range of colors</font><font color="#000000">
                  </font><font color="#5a5a5a">; if the number of groups is large, the colors are repeated but with different shades</font><font color="#000000">
                  </font><font color="#5a5a5a">; the higher the group number, the lighter the color shade </font><font color="#000000">
                  [</font><font color="#0000aa">let</font><font color="#000000"> ccolors </font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> </font><font color="#660096">base-colors</font><font color="#000000">
                  </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> ((</font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> ((</font><font color="#660096">length</font><font color="#000000"> ccolors) </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">int</font><font color="#000000"> ((i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> ccolors))))) ccolors) </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000"> ((i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> ccolors))))
                  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> ((</font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> ((</font><font color="#660096">length</font><font color="#000000"> ccolors) </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">int</font><font color="#000000"> ((i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> ccolors))))) ccolors) </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">int</font><font color="#000000"> ((i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">length</font><font color="#000000"> ccolors))))
     ]]                                  
   </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
   </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> components [</font><font color="#0000aa">stop</font><font color="#000000">]
   ]
</font><font color="#007f69">end</font><font color="#000000">
 
 
  
</font><font color="#5a5a5a">; procedure called by setup and by go</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-components
   </font><font color="#0000aa">let</font><font color="#000000"> groupsize </font><font color="#660096">n-values</font><font color="#000000"> (components) [</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> (? </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)]]
   </font><font color="#0000aa">let</font><font color="#000000"> sizerank </font><font color="#660096">reverse</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> groupsize
   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Component Number and Size&quot;</font><font color="#000000">
   </font><font color="#0000aa">clear-plot</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Size&quot;</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
   </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&lt;=</font><font color="#000000"> components 
   </font><font color="#5a5a5a">; color of component is defined based on the color of member turtles</font><font color="#000000">
   </font><font color="#5a5a5a">; which in turn depends on their z values</font><font color="#000000">
   </font><font color="#5a5a5a">; at setup, color, z and group number are basically the same</font><font color="#000000">
    [</font><font color="#0000aa">loop</font><font color="#000000">
    [</font><font color="#0000aa">let</font><font color="#000000"> c [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">all?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c])
        [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> c]
        </font><font color="#5a5a5a">; color is gray if turtles with different colors are in the same component (bridging)</font><font color="#000000">
        [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]
        </font><font color="#5a5a5a">; components are in descending order, depending on their size</font><font color="#000000">
        </font><font color="#0000aa">plotxy</font><font color="#000000"> (i) (</font><font color="#660096">item</font><font color="#000000"> (i </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) sizerank)
        </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
        </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> components [</font><font color="#0000aa">stop</font><font color="#000000">]
    ]]
</font><font color="#007f69">end</font><font color="#000000">                                            



</font><font color="#5a5a5a">; procedure called by setup</font><font color="#000000">
</font><font color="#5a5a5a">; at setup, z is attributed based on initial color</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> give-z
</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">
        [
        </font><font color="#5a5a5a">; for non-isolates</font><font color="#000000">
        </font><font color="#5a5a5a">; define z as the list of z1, z2, z3</font><font color="#000000">
        </font><font color="#5a5a5a">; set them to 0 to start</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> z (</font><font color="#660096">list</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)
        </font><font color="#5a5a5a">; j is a random variable which</font><font color="#000000">
        </font><font color="#5a5a5a">; determines whether value of a variable is below average (if j = 0)</font><font color="#000000">
        </font><font color="#5a5a5a">; or above average (j = 1)</font><font color="#000000">
        </font><font color="#0000aa">let</font><font color="#000000"> j </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
        </font><font color="#5a5a5a">; two of the values of z are close to color benchmark</font><font color="#000000">
        </font><font color="#5a5a5a">; the other value is less close and depends on the Dissonance parameter, which is user-defined</font><font color="#000000">
        </font><font color="#0000aa">ifelse</font><font color="#000000"> j </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [</font><font color="#0000aa">foreach</font><font color="#000000"> [</font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> ? z </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000">) </font><font color="#963700">0</font><font color="#000000">)]
                      </font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> z </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> Dissonance) </font><font color="#963700">0</font><font color="#000000">)]
                      
                      [</font><font color="#0000aa">foreach</font><font color="#000000"> [</font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">] [</font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> ? z </font><font color="#660096">min</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((group </font><font color="#660096">/</font><font color="#000000"> components) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000">) </font><font color="#963700">1</font><font color="#000000">)]
                      </font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> z </font><font color="#660096">min</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> Dissonance) </font><font color="#963700">1</font><font color="#000000">)]
        
        </font><font color="#5a5a5a">; now, reshuffle list</font><font color="#000000">
        </font><font color="#5a5a5a">; so that the potentially outlying value may be on any of the three dimensions</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">shuffle</font><font color="#000000"> z
        ]
        
        </font><font color="#5a5a5a">; isolates (no link-neighbors) do not have to conform to group values</font><font color="#000000">
         </font><font color="#5a5a5a">; so their z1 z2 and z3 are attributed randomly</font><font color="#000000">
        [</font><font color="#0000aa">set</font><font color="#000000"> z (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) (</font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">))]
        ]
</font><font color="#007f69">end</font><font color="#000000">
                    
                    
                    
</font><font color="#5a5a5a">; procedure called by setup and by go</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> do-layout
    </font><font color="#0000aa">layout-spring</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#963700">0.2</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">0.8</font><font color="#000000">
    </font><font color="#0000aa">display</font><font color="#000000">  </font><font color="#5a5a5a">;; so we get smooth animation</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;; Go Procedures ;;;</font><font color="#000000">
</font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000">

</font><font color="#5a5a5a">; this is a step in the simulation run</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> go
 
  </font><font color="#5a5a5a">; update tickcount</font><font color="#000000">
   </font><font color="#0000aa">tick</font><font color="#000000">
   
  </font><font color="#5a5a5a">; simulation stops if model has run 1500 times without changes (this is assumed to be the stationary state)</font><font color="#000000">
  </font><font color="#5a5a5a">; at this point, the model also exports results automatically</font><font color="#000000">
  </font><font color="#5a5a5a">; the command export-world writes the values of all variables and plots to an external file, in csv format</font><font color="#000000">
  </font><font color="#5a5a5a">; the name of the file includes the values of Dissonance and BondBridgThreshold being tested, plus the number of ticks necessary to achieve the stationary state</font><font color="#000000">
  </font><font color="#5a5a5a">; the latter is meant to ensure existing files will not be overwritten (which may still happen)</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> stationary </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1500</font><font color="#000000"> [</font><font color="#0000aa">export-world</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;D&quot;</font><font color="#000000"> Dissonance </font><font color="#963700">&quot;_BBT&quot;</font><font color="#000000"> BondBridgThreshold </font><font color="#963700">&quot;_Ticks&quot;</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#963700">&quot;.csv&quot;</font><font color="#000000">)
                        </font><font color="#0000aa">stop</font><font color="#000000">]


  </font><font color="#5a5a5a">; If the Interventions? toggle is on, we allow for the network provider to intervene</font><font color="#000000">
  </font><font color="#5a5a5a">; this means resetting all privacy levels to 0 if they have been above average for long</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> Interventions? [</font><font color="#0000aa">if</font><font color="#000000"> privacy-alert </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">500</font><font color="#000000">
                      [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#963700">0</font><font color="#000000">]
                      </font><font color="#0000aa">set</font><font color="#000000"> privacy-alert </font><font color="#963700">0</font><font color="#000000">
                    ]]
                      

  </font><font color="#5a5a5a">; this is to count changes (number of links stands for all other changes)</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> t </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">

  </font><font color="#5a5a5a">; depending on anomie settings, decide whether to form or break a link</font><font color="#000000">
  </font><font color="#5a5a5a">; depending on individual value of z with respect to color benchmark,</font><font color="#000000">
  </font><font color="#5a5a5a">; decide whether this will be a bond-type link or a bridge-type link</font><font color="#000000">
  </font><font color="#5a5a5a">; consequently, update z and if necessary, color</font><font color="#000000">
  </font><font color="#5a5a5a">; in Privacy-On simulations, also update x</font><font color="#000000">
  make-tie-choice

  </font><font color="#5a5a5a">; update count of changes</font><font color="#000000">

  </font><font color="#5a5a5a">; if no change in number of ties, update stationary</font><font color="#000000">
  </font><font color="#5a5a5a">; if there is a change, reset stationary to 0</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> t' </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000">
  </font><font color="#0000aa">ifelse</font><font color="#000000"> t' </font><font color="#660096">=</font><font color="#000000"> t [</font><font color="#0000aa">set</font><font color="#000000"> stationary stationary </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
                 </font><font color="#0000aa">set</font><font color="#000000"> t </font><font color="#963700">0</font><font color="#000000">
                 </font><font color="#0000aa">set</font><font color="#000000"> t' </font><font color="#963700">0</font><font color="#000000">
                 ]
                [</font><font color="#0000aa">set</font><font color="#000000"> stationary </font><font color="#963700">0</font><font color="#000000">
                 ]

  </font><font color="#5a5a5a">; update privacy alert</font><font color="#000000">
  </font><font color="#5a5a5a">; this is necessary to establish timing of interventions, if any</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [x] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0.5</font><font color="#000000">
           [</font><font color="#0000aa">set</font><font color="#000000"> privacy-alert privacy-alert </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]

  </font><font color="#5a5a5a">; update count of components and isolates</font><font color="#000000">
  </font><font color="#5a5a5a">; and update group variable</font><font color="#000000">
  detect-components
  
  </font><font color="#5a5a5a">; update layout</font><font color="#000000">
  do-layout     
  </font><font color="#5a5a5a">; update plot of component number and size</font><font color="#000000">
  plot-components
  </font><font color="#5a5a5a">; plot evolution of density, share of isolates, part of homophily</font><font color="#000000">
  plot-density
  </font><font color="#5a5a5a">; plot values of individual variables</font><font color="#000000">
  plot-privacy
  plot-z1
  plot-z2
  plot-z3

</font><font color="#007f69">end</font><font color="#000000">




</font><font color="#5a5a5a">; procedure called by go</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> make-tie-choice

  </font><font color="#5a5a5a">; select one turtle randomly</font><font color="#000000">
  </font><font color="#5a5a5a">; call it &quot;actor&quot;</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> actor </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">
  </font><font color="#5a5a5a">; take a random number</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> proba </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">

  </font><font color="#0000aa">ask</font><font color="#000000"> actor [</font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">
           
           </font><font color="#5a5a5a">; if actor has friends, i.e. link-neighbors (for this to be true, one must have number of components &gt; 0 in the system)</font><font color="#000000">
           
           [
           </font><font color="#5a5a5a">; define color-based benchmark</font><font color="#000000">
           </font><font color="#5a5a5a">; and define distance of actor with respect to benchmark as z(dist)= absolute value of [z(actor)-(color reference)]</font><font color="#000000">
           </font><font color="#5a5a5a">; p.s. benchmark is defined based on color variable, normalized to obtain a real number in the 0-1 interval</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> zdist </font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> (? </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">))] z
           </font><font color="#5a5a5a">; this will be used to define whether the tie to be formed or broken will be bond or bridge</font><font color="#000000">
           
           </font><font color="#5a5a5a">; if proba is higher than a, go to the form-tie procedure</font><font color="#000000">
           </font><font color="#5a5a5a">; this means that higher tendency to anomie implies lower tendency to form ties</font><font color="#000000">
            </font><font color="#0000aa">ifelse</font><font color="#000000"> proba </font><font color="#660096">&gt;</font><font color="#000000"> a [form-tie]
            </font><font color="#5a5a5a">; otherwise, go to the break tie procedure</font><font color="#000000">
            </font><font color="#5a5a5a">; this means that higher tendency to anomie implies higher tendency to break ties</font><font color="#000000">
                                   [break-tie]
           
           ]
           
           </font><font color="#5a5a5a">; if actor has no friends, it can only form a new tie by bridging</font><font color="#000000">
           </font><font color="#5a5a5a">; this will happen if proba is higher than a</font><font color="#000000">
           </font><font color="#5a5a5a">; otherwise, actor will just update its count of missed opportunities</font><font color="#000000">
             [</font><font color="#0000aa">ifelse</font><font color="#000000"> proba </font><font color="#660096">&gt;</font><font color="#000000"> a [form-bridge]
                               [</font><font color="#0000aa">set</font><font color="#000000"> missed missed </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]]
 
  </font><font color="#5a5a5a">; after making a relational choice, adjust values of z</font><font color="#000000">
  </font><font color="#5a5a5a">; to fit better with values of friends </font><font color="#000000">
  adjust-z
  </font><font color="#5a5a5a">; adjust color too</font><font color="#000000">
  adjust-color
  </font><font color="#5a5a5a">; calculate clustering coefficient of agent (its local density)</font><font color="#000000">
  find-clustering-coefficient
  </font><font color="#5a5a5a">; also adjust privacy settings (in Privacy simulations only)</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> Privacy? [adjust-x]]
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">; procedure called by make-tie-choice           </font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> form-tie
           
           </font><font color="#5a5a5a">; first, see if z of actor is close to color benchmark</font><font color="#000000">
           </font><font color="#5a5a5a">; how close it should be depends on the parameter BondBridgThreshold </font><font color="#000000">
           </font><font color="#5a5a5a">; BondBridgThreshold is user-defined</font><font color="#000000">
           
           </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> zdist </font><font color="#660096">&lt;=</font><font color="#000000"> BondBridgThreshold
           </font><font color="#5a5a5a">; if lower or equal, form a tie with someone in the group and of the same color</font><font color="#000000">
           [form-bond]
           </font><font color="#5a5a5a">; otherwise, form a bridging tie</font><font color="#000000">
           [form-bridge]
           
</font><font color="#007f69">end</font><font color="#000000">




</font><font color="#5a5a5a">; procedure called by form-tie</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> form-bond
   </font><font color="#0000aa">let</font><font color="#000000"> w </font><font color="#660096">who</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> za z
   </font><font color="#0000aa">let</font><font color="#000000"> g group
   </font><font color="#0000aa">let</font><font color="#000000"> c </font><font color="#660096">color</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> similars </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(x </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> w </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (group </font><font color="#660096">=</font><font color="#000000"> g) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c)]
            </font><font color="#5a5a5a">; similars are candidates for bonding link formation</font><font color="#000000">
            </font><font color="#5a5a5a">; they must be visible turtles</font><font color="#000000">
            </font><font color="#5a5a5a">; should not already have a link with actor</font><font color="#000000">
            </font><font color="#5a5a5a">; should be of the same group and same color</font><font color="#000000">
            </font><font color="#5a5a5a">; continue if there is at least one other similar</font><font color="#000000">
            
            </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> similars
            </font><font color="#5a5a5a">; if there are similars, calculate similarity scores based on values of z</font><font color="#000000">
            </font><font color="#5a5a5a">; for the three dimensions of z</font><font color="#000000">
            </font><font color="#5a5a5a">; and take the one with lowest difference from value of actor</font><font color="#000000">
            
              [
               </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> similars [</font><font color="#0000aa">let</font><font color="#000000"> ddz (</font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((?1) </font><font color="#660096">-</font><font color="#000000"> (?2))] za ([z] </font><font color="#660096">of</font><font color="#000000"> ?))
                
                                      </font><font color="#0000aa">ask</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> dz </font><font color="#660096">min</font><font color="#000000"> ddz]
                                      ]                      
               </font><font color="#0000aa">let</font><font color="#000000"> best </font><font color="#660096">min-one-of</font><font color="#000000"> similars [dz]
               </font><font color="#5a5a5a">; rename &quot;best&quot; the similar with the closest value of one of the zs</font><font color="#000000">
               </font><font color="#5a5a5a">; it is the best candidate to new link formation</font><font color="#000000">
               </font><font color="#0000aa">create-link-with</font><font color="#000000"> best
              ]
              
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">; procedure called by form-tie</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> form-bridge
   </font><font color="#0000aa">let</font><font color="#000000"> w </font><font color="#660096">who</font><font color="#000000">
   </font><font color="#0000aa">let</font><font color="#000000"> g group
   </font><font color="#0000aa">let</font><font color="#000000"> za z
   </font><font color="#0000aa">let</font><font color="#000000"> strangers </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(x </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">link-with</font><font color="#000000"> </font><font color="#660096">turtle</font><font color="#000000"> w </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> ((group </font><font color="#660096">!=</font><font color="#000000"> g) </font><font color="#660096">or</font><font color="#000000"> (group </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">))]

   </font><font color="#5a5a5a">; strangers are isolates and/or those who belong to different components</font><font color="#000000">
   </font><font color="#5a5a5a">; whose privacy settings allow contact</font><font color="#000000">
   </font><font color="#5a5a5a">; and who do not already have links with actor</font><font color="#000000">
          </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> strangers
          </font><font color="#5a5a5a">; continue if there is at least one stranger</font><font color="#000000">
         [
          </font><font color="#5a5a5a">; if there are strangers, calculate similarity scores based on values of z</font><font color="#000000">
          </font><font color="#5a5a5a">; for the three dimensions of z</font><font color="#000000">
          </font><font color="#5a5a5a">; and take the one with lowest difference from value of actor</font><font color="#000000">
         </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> strangers [</font><font color="#0000aa">let</font><font color="#000000"> ddz (</font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((?1) </font><font color="#660096">-</font><font color="#000000"> (?2))] za ([z] </font><font color="#660096">of</font><font color="#000000"> ?))
               
                                      </font><font color="#0000aa">ask</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> dz </font><font color="#660096">min</font><font color="#000000"> ddz]
                                ]                        
         </font><font color="#0000aa">let</font><font color="#000000"> beststr </font><font color="#660096">min-one-of</font><font color="#000000"> strangers [dz]
         </font><font color="#5a5a5a">; rename &quot;beststr&quot; the stranger with the closest value of one of the zs</font><font color="#000000">
         </font><font color="#5a5a5a">; it is the best candidate to new link formation</font><font color="#000000">
         </font><font color="#0000aa">create-link-with</font><font color="#000000"> beststr
         ]
         
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">; procedure called by make-tie-choice</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> break-tie
           
           </font><font color="#5a5a5a">; first, see if z of actor is close to color benchmark</font><font color="#000000">
           </font><font color="#5a5a5a">; how close it should be depends on the parameter BondBridgThreshold </font><font color="#000000">
           </font><font color="#5a5a5a">; BondBridgThreshold is user-defined</font><font color="#000000">
           
           </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> zdist </font><font color="#660096">&gt;</font><font color="#000000"> BondBridgThreshold
           </font><font color="#5a5a5a">; if higher or equal, break a tie with someone in the group and of the same color</font><font color="#000000">
           [break-bond]
           </font><font color="#5a5a5a">; otherwise, break a bridging tie</font><font color="#000000">
           [break-bridge]
 </font><font color="#007f69">end</font><font color="#000000">
           


</font><font color="#5a5a5a">; procedure called by break-tie</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> break-bond
       </font><font color="#0000aa">let</font><font color="#000000"> za z
       </font><font color="#0000aa">let</font><font color="#000000"> c </font><font color="#660096">color</font><font color="#000000">
       </font><font color="#0000aa">let</font><font color="#000000"> closefriends </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c)]
       </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> closefriends
              [</font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> closefriends  [</font><font color="#0000aa">let</font><font color="#000000"> ddz (</font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((?1) </font><font color="#660096">-</font><font color="#000000"> (?2))] za ([z] </font><font color="#660096">of</font><font color="#000000"> ?))
                                           </font><font color="#0000aa">ask</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> dz </font><font color="#660096">max</font><font color="#000000"> ddz]]                       
              </font><font color="#0000aa">let</font><font color="#000000"> worstclosefriend </font><font color="#660096">max-one-of</font><font color="#000000"> closefriends [dz]  
              </font><font color="#5a5a5a">; rename &quot;worst&quot; the friend with the most distant value of one of the zs</font><font color="#000000">
              </font><font color="#5a5a5a">; it is the best candidate to link deletion</font><font color="#000000">
              </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> worstclosefriend [</font><font color="#0000aa">die</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">; procedure called by break-tie</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> break-bridge
        </font><font color="#0000aa">let</font><font color="#000000"> za z
        </font><font color="#0000aa">let</font><font color="#000000"> c </font><font color="#660096">color</font><font color="#000000">
        </font><font color="#0000aa">let</font><font color="#000000"> farfriends </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [(</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> c) </font><font color="#660096">or</font><font color="#000000"> (</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">)]
        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> farfriends
             [</font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> farfriends  [</font><font color="#0000aa">let</font><font color="#000000"> ddz (</font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((?1) </font><font color="#660096">-</font><font color="#000000"> (?2))] za ([z] </font><font color="#660096">of</font><font color="#000000"> ?))
                                        </font><font color="#0000aa">ask</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> dz </font><font color="#660096">max</font><font color="#000000"> ddz]]                       
             </font><font color="#0000aa">let</font><font color="#000000"> worstfarfriend </font><font color="#660096">max-one-of</font><font color="#000000"> farfriends [dz]  
             </font><font color="#5a5a5a">; rename &quot;worst&quot; the friend with the most distant value of one of the zs</font><font color="#000000">
             </font><font color="#5a5a5a">; it is the best candidate to link deletion</font><font color="#000000">
        </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> worstfarfriend [</font><font color="#0000aa">die</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">; procedure called by make-tie-choice</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> adjust-z
      </font><font color="#5a5a5a">; only if actor has friends</font><font color="#000000">
        </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">
        </font><font color="#5a5a5a">; take average of z values of friends, each dimension separately</font><font color="#000000">
        [</font><font color="#0000aa">let</font><font color="#000000"> meanz (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">) (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">) (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">))
        </font><font color="#5a5a5a">; measure the difference between the value of actor and the average of friends, for each dimension</font><font color="#000000">
        </font><font color="#0000aa">let</font><font color="#000000"> dmz (</font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((?1) </font><font color="#660096">-</font><font color="#000000"> (?2))] z meanz)
        </font><font color="#0000aa">let</font><font color="#000000"> adjz </font><font color="#660096">max</font><font color="#000000"> dmz
        </font><font color="#5a5a5a">; find the maximum of dmz, i.e. the dimension of z for which</font><font color="#000000">
        </font><font color="#5a5a5a">; the deviation from friends is highest</font><font color="#000000">
        </font><font color="#0000aa">let</font><font color="#000000"> posadjz </font><font color="#660096">position</font><font color="#000000"> adjz dmz
        </font><font color="#0000aa">let</font><font color="#000000"> diffz ((</font><font color="#660096">item</font><font color="#000000"> posadjz z) </font><font color="#660096">-</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> posadjz meanz))
        </font><font color="#5a5a5a">; on this dimension, if the value of actor is higher than average, reduce it;</font><font color="#000000">
        </font><font color="#5a5a5a">; otherwise increase it</font><font color="#000000">
        </font><font color="#5a5a5a">; rate of increase or decrease is given by adjust-z-rate</font><font color="#000000">
        </font><font color="#5a5a5a">; the latter depends on Dissonance</font><font color="#000000">
        </font><font color="#0000aa">let</font><font color="#000000"> adjust-z-rate (</font><font color="#963700">0.01</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> (Dissonance </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.01</font><font color="#000000">))
        </font><font color="#0000aa">ifelse</font><font color="#000000"> diffz </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> posadjz z </font><font color="#660096">max</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((</font><font color="#660096">item</font><font color="#000000"> posadjz z) </font><font color="#660096">-</font><font color="#000000"> adjust-z-rate) </font><font color="#963700">0</font><font color="#000000">)]
                         [</font><font color="#0000aa">set</font><font color="#000000"> z </font><font color="#660096">replace-item</font><font color="#000000"> posadjz z </font><font color="#660096">min</font><font color="#000000"> (</font><font color="#660096">list</font><font color="#000000"> ((</font><font color="#660096">item</font><font color="#000000"> posadjz z) </font><font color="#660096">+</font><font color="#000000"> adjust-z-rate) </font><font color="#963700">1</font><font color="#000000">)]
         
         </font><font color="#5a5a5a">; then check if the change in z requires a change in color</font><font color="#000000">
         ]
       
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#5a5a5a">; procedure called by adjust-z</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> adjust-color
    </font><font color="#5a5a5a">; actor can remain of the same color or change</font><font color="#000000">
    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">
    </font><font color="#5a5a5a">; this depends on whether or not actor has friends</font><font color="#000000">
    [</font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]
    </font><font color="#5a5a5a">; this depends on whether actor has any links to other actors</font><font color="#000000">
    </font><font color="#5a5a5a">; who are part of groups rather than former isolates</font><font color="#000000">
    [</font><font color="#0000aa">let</font><font color="#000000"> candcolors (</font><font color="#660096">map</font><font color="#000000"> [[</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> ?] </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">])
     </font><font color="#0000aa">let</font><font color="#000000"> diffcolors </font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> ((</font><font color="#660096">mean</font><font color="#000000"> z) </font><font color="#660096">-</font><font color="#000000"> (? </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">))] candcolors  
     </font><font color="#0000aa">let</font><font color="#000000"> bestcolor </font><font color="#660096">min</font><font color="#000000"> diffcolors
     </font><font color="#0000aa">let</font><font color="#000000"> posbcolor </font><font color="#660096">position</font><font color="#000000"> bestcolor diffcolors
     </font><font color="#5a5a5a">; this will be the color of actor</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">item</font><font color="#000000"> posbcolor candcolors
     </font><font color="#0000aa">let</font><font color="#000000"> c </font><font color="#660096">color</font><font color="#000000">
     </font><font color="#5a5a5a">; update color of links</font><font color="#000000">
     </font><font color="#0000aa">foreach</font><font color="#000000"> </font><font color="#660096">sort</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [</font><font color="#0000aa">ifelse</font><font color="#000000"> ([</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> ? </font><font color="#660096">=</font><font color="#000000"> c)
                    [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> c]]
                    [</font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-with</font><font color="#000000"> ? [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]]]]

     </font><font color="#5a5a5a">; if actor's links are only to former isolates</font><font color="#000000">
     </font><font color="#5a5a5a">; then convert to the color that is nearest to all</font><font color="#000000">
     [</font><font color="#0000aa">let</font><font color="#000000"> meanz (</font><font color="#660096">list</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">) (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">) (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000">)) 
      </font><font color="#0000aa">let</font><font color="#000000"> meanzz </font><font color="#660096">mean</font><font color="#000000"> (</font><font color="#660096">map</font><font color="#000000"> [(?1 </font><font color="#660096">+</font><font color="#000000"> ?2) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] z meanz) 
      </font><font color="#0000aa">let</font><font color="#000000"> diffcolors </font><font color="#660096">map</font><font color="#000000"> [</font><font color="#660096">abs</font><font color="#000000"> (meanzz </font><font color="#660096">-</font><font color="#000000"> (? </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">))] (</font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> </font><font color="#660096">base-colors</font><font color="#000000">)  
      </font><font color="#0000aa">let</font><font color="#000000"> bestcolor </font><font color="#660096">min</font><font color="#000000"> diffcolors
      </font><font color="#0000aa">let</font><font color="#000000"> posbcolor </font><font color="#660096">position</font><font color="#000000"> bestcolor diffcolors
      </font><font color="#5a5a5a">; this will be the color of actor</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> (</font><font color="#660096">item</font><font color="#000000"> posbcolor (</font><font color="#660096">remove</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000"> </font><font color="#660096">base-colors</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (meanzz </font><font color="#660096">-</font><font color="#000000"> (bestcolor </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">140</font><font color="#000000">)))
      </font><font color="#0000aa">let</font><font color="#000000"> c </font><font color="#660096">color</font><font color="#000000">
      </font><font color="#5a5a5a">; update color of links</font><font color="#000000">
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> c]
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> c]
      ]
     ]

   </font><font color="#5a5a5a">; if actor is an isolate, its color is black</font><font color="#000000">
   [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]
</font><font color="#007f69">end</font><font color="#000000"> 



</font><font color="#5a5a5a">; the following procedure is called by make-tie-choice</font><font color="#000000">
</font><font color="#5a5a5a">; and leads to update of privacy </font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> adjust-x
  
  </font><font color="#5a5a5a">; isolates that have missed 10 attempts to form links</font><font color="#000000">
  </font><font color="#5a5a5a">; will make themselves visible</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> ((missed </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (x </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#963700">0</font><font color="#000000">
                                  </font><font color="#0000aa">set</font><font color="#000000"> missed </font><font color="#963700">0</font><font color="#000000">]
  
  </font><font color="#5a5a5a">; connected and visible nodes may make themselves visible to friends only</font><font color="#000000">
  </font><font color="#5a5a5a">; the conditions under which they do so may be network size or density</font><font color="#000000">
  
  </font><font color="#0000aa">if</font><font color="#000000"> Sensitivity </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Network density&quot;</font><font color="#000000"> [</font><font color="#0000aa">if</font><font color="#000000"> node-clustering-coefficient </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0.75</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#963700">1</font><font color="#000000">]]
  </font><font color="#0000aa">if</font><font color="#000000"> Sensitivity </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">&quot;Network Size&quot;</font><font color="#000000"> [</font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">my-links</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> (#Agents </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">)) </font><font color="#660096">and</font><font color="#000000"> (x </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)) [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#963700">1</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">






</font><font color="#5a5a5a">;; Clustering computations</font><font color="#000000">
</font><font color="#5a5a5a">;; this procedure is called by make-tie-choice</font><font color="#000000">
</font><font color="#5a5a5a">; to calculate clustering coefficient</font><font color="#000000">
</font><font color="#007f69">to-report</font><font color="#000000"> in-cluster? [hood]
  </font><font color="#0000aa">report</font><font color="#000000"> ( </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">end1</font><font color="#000000"> hood </font><font color="#660096">and</font><font color="#000000"> </font><font color="#660096">member?</font><font color="#000000"> </font><font color="#660096">end2</font><font color="#000000"> hood )
</font><font color="#007f69">end</font><font color="#000000">


</font><font color="#007f69">to</font><font color="#000000"> find-clustering-coefficient

</font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">link-neighbors</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      [ </font><font color="#0000aa">set</font><font color="#000000"> node-clustering-coefficient </font><font color="#963700">0</font><font color="#000000"> ]
      [
        </font><font color="#0000aa">let</font><font color="#000000"> hood </font><font color="#660096">link-neighbors</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> node-clustering-coefficient (</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [ in-cluster? hood ] </font><font color="#660096">/</font><font color="#000000"> ((</font><font color="#660096">count</font><font color="#000000"> hood) </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> hood </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) )
      ]
  
</font><font color="#007f69">end</font><font color="#000000">




</font><font color="#5a5a5a">; the following procedure is called by go</font><font color="#000000">
</font><font color="#5a5a5a">; updates value of Density and plots its value</font><font color="#000000">
</font><font color="#5a5a5a">; ticks on x-axis, and Density  + Share isolates on y-axis</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-density
   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Density&quot;</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Density&quot;</font><font color="#000000">
   </font><font color="#0000aa">set</font><font color="#000000"> Density (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">links</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> ((#Agents </font><font color="#660096">*</font><font color="#000000"> (#Agents </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">)) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">))

   </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> Density

   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Clustering coefficient&quot;</font><font color="#000000">
   </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [node-clustering-coefficient] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">)
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">; the following procedure is called by go</font><font color="#000000">
</font><font color="#5a5a5a">; plots values of individual variable x, with ticks on x axis</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-privacy
   </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;Average Privacy&quot;</font><font color="#000000">
   </font><font color="#0000aa">set-current-plot-pen</font><font color="#000000"> </font><font color="#963700">&quot;Mean x&quot;</font><font color="#000000">
   </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> </font><font color="#660096">mean</font><font color="#000000"> [x] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">



</font><font color="#5a5a5a">; the following procedure is called by go</font><font color="#000000">
</font><font color="#5a5a5a">; plots values of individual variable z1, with ticks on x axis</font><font color="#000000">
</font><font color="#5a5a5a">; takes into account both global average and average of groups</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-z1
  </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;z1&quot;</font><font color="#000000">
  
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] 
    [</font><font color="#0000aa">loop</font><font color="#000000">
    [</font><font color="#0000aa">create-temporary-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Group&quot;</font><font color="#000000"> i)
    </font><font color="#0000aa">set-plot-pen-mode</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> c [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">all?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c])
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> c]
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]
    </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i])
    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> components [</font><font color="#0000aa">stop</font><font color="#000000">]
    ]]
</font><font color="#007f69">end</font><font color="#000000">                        
 
 
</font><font color="#5a5a5a">; the following procedure is called by go</font><font color="#000000">
</font><font color="#5a5a5a">; plots values of individual variable z2, with ticks on x axis</font><font color="#000000">
</font><font color="#5a5a5a">; takes into account both global average and average of groups</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-z2
    </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;z2&quot;</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] 
    [</font><font color="#0000aa">loop</font><font color="#000000">
    [</font><font color="#0000aa">create-temporary-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Group&quot;</font><font color="#000000"> i)
    </font><font color="#0000aa">set-plot-pen-mode</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> c [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">all?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c])
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> c]
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]
    </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i])
    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> components [</font><font color="#0000aa">stop</font><font color="#000000">]
    ]]
</font><font color="#007f69">end</font><font color="#000000">                        



</font><font color="#5a5a5a">; the following procedure is called by go</font><font color="#000000">
</font><font color="#5a5a5a">; plots values of individual variable z3, with ticks on x axis</font><font color="#000000">
</font><font color="#5a5a5a">; takes into account both global average and average of groups</font><font color="#000000">
</font><font color="#007f69">to</font><font color="#000000"> plot-z3
    </font><font color="#0000aa">set-current-plot</font><font color="#000000"> </font><font color="#963700">&quot;z3&quot;</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] 
    [</font><font color="#0000aa">loop</font><font color="#000000">
    [</font><font color="#0000aa">create-temporary-plot-pen</font><font color="#000000"> (</font><font color="#660096">word</font><font color="#000000"> </font><font color="#963700">&quot;Group&quot;</font><font color="#000000"> i)
    </font><font color="#0000aa">set-plot-pen-mode</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">let</font><font color="#000000"> c [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i]
    </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#660096">all?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i] [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> c])
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> c]
    [</font><font color="#0000aa">set-plot-pen-color</font><font color="#000000"> </font><font color="#963700">gray</font><font color="#000000">]
    </font><font color="#0000aa">plotxy</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> (</font><font color="#660096">mean</font><font color="#000000"> [</font><font color="#660096">item</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> z] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [group </font><font color="#660096">=</font><font color="#000000"> i])
    </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">&gt;</font><font color="#000000"> components [</font><font color="#0000aa">stop</font><font color="#000000">]
    ]]
</font><font color="#007f69">end</font><font color="#000000">                        </font>
</pre>

</body>
</html>
